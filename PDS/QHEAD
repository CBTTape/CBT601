         MACRO
&NAME    QHEAD &MSGVAR,&ATTR,&TYP=0,&SEL=N,&DMY=N
&NAME    L     R15,QVDSPL          LOAD BASE REG
         USING QDISPLAY,R15        BASE REG FOR DISPLAY WORK AREA
         L     R14,QDHLINE@        POINT TO HEADING LINE
         MVC   0(80,R14),&MSGVAR
         L     R14,QDSHADO@        POINT TO THE SHADOW BUFFER
         AH    R14,QDLNELEN        POINT TO HEADING LINE SHADOW
         MVI   0(R14),&ATTR        SUPPLY HEADING CHARACTER ATTRIBUTES
         MVC   1(79,R14),0(R14)
         MVI   QDISPTYP,&TYP       SET SELECTION CODE DISPLAY TYPE
         MVI   QDLNCODE,X'05'      SET DATA DISPLAY TO TURQUOISE
         DROP  R15
         AIF   ('&DMY' EQ 'Y').MEND
         AIF   ('&SEL' NE 'Y').SELOK
         TM    QFLAG1,QFLG1SEL     LINE SELECTION OR PF3/15?
         BO    *+8                 YES, DO NOT RESET "PF3 LEVEL"
.SELOK   ANOP
         MVI   PF3LEVEL+1,0        RESET "PF3 LEVEL" FOR NEW COMMAND
         NI    QFLAG1,255-QFLG1SEL RESET LINE SELECTION FLAG
.MEND    ANOP
         MEND
